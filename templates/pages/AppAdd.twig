

{% block content %}
<section class="bg-white rounded-lg shadow-md p-6">
  <h3 class="text-xl font-semibold mb-4">
    {% if ticket %}Edit Ticket{% else %}Create New Ticket{% endif %}
  </h3>
  <form action="{{ "" }}" method="POST" class="space-y-4" id="ticketForm">
    <div>
      <label
        for="title"
        class="block text-sm font-medium text-gray-700"
      >
        Title
      </label>
      <input
        id="title"
        name="title"
        value="{{ ticket ? ticket.title : '' }}"
        type="text"
        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-cyan-500 focus:ring-cyan-200"
        placeholder="Short summary"
        required
      />
      {% if errors.title %}
        <p class="text-red-600 text-sm mt-1">{{ errors.title }}</p>
      {% endif %}
    </div>

    <div>
      <label
        for="description"
        class="block text-sm font-medium text-gray-700"
      >
        Description
      </label>
      <textarea
        id="description"
        name="description"
        rows="4"
        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-cyan-500 focus:ring-cyan-200"
        placeholder="Describe the issue in detail"
        required
      >{{ ticket ? ticket.description : '' }}</textarea>
      {% if errors.description %}
        <p class="text-red-600 text-sm mt-1">{{ errors.description }}</p>
      {% endif %}
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label
          for="assignee"
          class="block text-sm font-medium text-gray-700"
        >
          Assignee
        </label>
        <input
          id="assignee"
          name="assignee"
          value="{{ ticket ? ticket.assignee : '' }}"
          type="text"
          class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-cyan-500 focus:ring-cyan-200"
          placeholder="Assign to"
          required
        />
        {% if errors.assignee %}
          <p class="text-red-600 text-sm mt-1">{{ errors.assignee }}</p>
        {% endif %}
      </div>

      <div>
        <label
          for="priority"
          class="block text-sm font-medium text-gray-700"
        >
          Priority
        </label>
        <select
          id="priority"
          name="priority"
          class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-cyan-500 focus:ring-cyan-200"
        >
          <option value="Low" {% if ticket and ticket.priority == 'Low' %}selected{% endif %}>Low</option>
          <option value="Medium" {% if not ticket or ticket.priority == 'Medium' %}selected{% endif %}>Medium</option>
          <option value="High" {% if ticket and ticket.priority == 'High' %}selected{% endif %}>High</option>
        </select>
      </div>
    </div>

    <div class="flex items-center justify-end gap-3 pt-2">
      <a
        href="{{ "" }}"
        class="px-4 py-2 bg-gray-100 rounded-md hover:bg-gray-200"
      >
        Cancel
      </a>
      <button
        type="submit"
        class="px-4 py-2 bg-cyan-600 text-white rounded-md hover:bg-cyan-700 disabled:opacity-70"
        id="submitButton"
      >
        {{ ticket ? 'Update' : 'Create' }}
      </button>
    </div>
  </form>
</section>
{% endblock %}

{% block javascripts %}
<script>
document.getElementById('ticketForm').addEventListener('submit', function(e) {
  const submitBtn = document.getElementById('submitButton');
  submitBtn.disabled = true;
  submitBtn.textContent = '{{ ticket ? 'Updating...' : 'Creating...' }}';
});
</script>
{% endblock %}
